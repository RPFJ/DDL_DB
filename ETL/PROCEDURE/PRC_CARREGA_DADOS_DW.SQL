create or replace NONEDITIONABLE PROCEDURE PRC_CARREGA_DADOS_DW(p_excluir IN CHAR) AS
    v_log ADM_LOG_DS.ACONTECIMENTO%TYPE; 

BEGIN
    /*=== DIMENS√ÉO ===*/
    PRC_IU_D_COOPERATIVA;
    PRC_IU_D_REDE_PRODUTIVA;

    /*=== FATO ===*/
    PRC_I_F_EVOLUCAO();
    PRC_I_F_DESENVOLVIMENTO_LOCAL(p_excluir);
    PRC_I_F_DESENVOLVIMENTO_COLETA(p_excluir);

    BEGIN
        INSERT INTO ADM_LOG_DS (
            ID_LOG
            , PASSO
            , TIPO
            , ACONTECIMENTO
        ) VALUES (
            SEQ_ADM_LOG_DS.NEXTVAL
            , 'CARREGANDO DADOS [PRC_CARREGA_DADOS_DW]'
            , 'T'
            , 'CARGA DE DE DADOS REALIZADA COM SUCESSO'
        );
    END;
    COMMIT;
EXCEPTION 
    WHEN OTHERS THEN 
        ROLLBACK;

        v_log := 'FALHA NA TRANSFORMACAO DE DADOS [' || SQLERRM || ']' || 'ERROR ['|| DBMS_UTILITY.FORMAT_ERROR_BACKTRACE || '] '; 

        INSERT INTO ADM_LOG_DS (
            ID_LOG
            , PASSO
            , TIPO
            , ACONTECIMENTO
        ) VALUES (
            SEQ_ADM_LOG_DS.NEXTVAL
            , 'CARREGANDO DADOS [PRC_CARREGA_DADOS_DW]'
            , 'F'
            , v_log
        );
END PRC_CARREGA_DADOS_DW;